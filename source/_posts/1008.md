---
title: 考无忧模拟考试题库软件的分析破解
date: 2019-03-14 18:43:08
tags: [考无忧, 破解]
---

本文基于52pojie大佬肥牛的[考无忧2017离线注册算法分析](https://www.52pojie.cn/thread-613378-1-1.html) 一文中的算法分析，使用python写了一个离线注册的脚本，理论上支持考无忧旗下所有的模拟考试题库软件。

<!-- more -->

# 注册算法分析

大佬使用OD分析了模拟考试软件的算法，而且其中涉及到注册码算法的关键部分，还写了详细的注释，方便我们的理解。

![](./1008/1.PNG)

![](./1008/2.PNG)

# 离线注册代码

分析OD内容，加密算法其实很简单，字符串拼接，两次MD5处理，每次均取前20位，最后每5位一组分开，中间用-连接即为真正的离线注册码。

写脚本如下：

``` python
import hashlib

def md5(arg):
	return hashlib.md5(arg.encode("utf-8")).hexdigest()

def cal(machine, login, subject):
	machine = machine.replace('-','')
	input = machine + '&' + login + '&' + subject
	secret1 = md5(input)[0:20].upper()
	secret2 = md5(secret1).upper()
	output = secret2[:5]+'-'+ secret2[5:10]+'-'+ secret2[10:15]+'-'+ secret2[15:20]
	print(output)

if __name__ == '__main__':

	login = '1234512345123451234512345'    //注册码
	subject = 'Word2003'                   //注册科目
	machine = '4B324-54B7D-8DB83-70CFD'    //机器码

	cal(machine, login, subject)
```

# 离线激活测试

首先将软件禁止联网，转离线激活页，将`注册码`、`注册科目`、`机器码`分别复制到脚本中的`login`、`subject`、`machine`项，运行得到离线激活码，激活成功，重启即可。

![](./1008/3.PNG)